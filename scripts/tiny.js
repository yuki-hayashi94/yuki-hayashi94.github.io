function rnd(){return iseed=1027*iseed%1048576,iseed/1048576}function surf(){x<0?(iv=9,nout1+=1):x>xmax&&(iv=9,nout2+=1)}function gauss(){var k=new Array(nx1+1),a=new Array(nx1+1);for(i=1;i<=nx;i++)k[i]=0,a[i]=0,vQ[i]=0;for(k[2]=vEp[2][2]/vEp[2][3],a[2]=vG[2]/vEp[2][3],i=3;i<=nx-1;i++)k[i]=vEp[i][2]/(vEp[i][3]-vEp[i][1]*k[i-1]),a[i]=(vG[i]-vEp[i][1]*a[i-1])/(vEp[i][3]-vEp[i][1]*k[i-1]);for(vQ[nx-1]=a[nx-1],i=nx-2;i>=2;i--)vQ[i]=a[i]-k[i]*vQ[i+1]}function drift(k){9!=iv&&(i=Math.max(0,Math.min(Math.floor(x/dx+.5),nx1)),dkx=qhf[i]*k,hmt=hm*k,x+=hmt*(kx+.5*dkx),kx+=dkx,surf())}function crea(k){iv=1,"yes"===ifermi?(re0=1/(1+Math.exp(-efermi/bktq)),ransu=re0*rnd(),ei=efermi-bktq*Math.log(ransu/(1-ransu))):"no"===ifermi&&(eix=-bktq*Math.log(rnd())*.5,eiy=-bktq*Math.log(rnd())*.5,eiz=-bktq*Math.log(rnd())*.5),akx=smh*Math.sqrt(eix),aky=smh*Math.sqrt(eiy),akz=smh*Math.sqrt(eiz),cb=rnd(),sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),sf=Math.sin(fai),cf=Math.cos(fai),kx=akx,ky=aky,kz=akz,ts=t-Math.log(rnd())/gm1,1==k?x=dx*areainj*rnd():2==k&&(kx=-kx,x=xmax-dx*areainj*rnd()),affi=1}function scat(){9!=iv&&(skx=kx*kx,sky=ky*ky,skz=kz*kz,sk=skx+sky+skz,0!=sk&&(x<=ivleft*dx||x>=ivright*dx?goto_1000():goto_2000()))}function goto_1000(){if(ki=Math.sqrt(sk),ei=hhm*sk,ie=Math.max(1,Math.min(Math.floor(ei/de)+1,iemax)),r1=rnd(),r1<=swk[1][1][ie]){if(ef=ei-hwo,ef<=0)return;nsopte1+=1,goto_20_40()}else r1<=swk[1][2][ie]?(ef=ei+hwo,nsopta1+=1,goto_20_40()):r1<=swk[1][3][ie]?(ef=ei,kf=ki,nsaco1+=1,goto_30()):r1<swk[1][4][ie]&&(ef=ei,r2=rnd(),cb=1-2*r2/(1+4*(1-r2)*sk/qd2),kf=ki,nsimp1+=1,goto_40())}function goto_2000(){if(ki=Math.sqrt(sk),ei=hhm*sk,ie=Math.max(1,Math.min(Math.floor(ei/de)+1,iemax)),r1=rnd(),r1<=swk[2][1][ie]){if(ef=ei-hwo,ef<=0)return;nsopte2=nsopte1+1,goto_20_40()}else r1<=swk[2][2][ie]?(ef=ei+hwo,nsopta2+=1,goto_20_40()):r1<=swk[2][3][ie]?(ef=ei,kf=ki,nsaco2+=1,goto_30()):r1<swk[2][4][ie]&&(ef=ei,r2=rnd(),cb=1-2*r2/(1+4*(1-r2)*sk/qd2_w),kf=ki,nsimp2+=1,goto_40())}function goto_20_40(){kf=smh*Math.sqrt(ef),f=2*ki*kf/(ki-kf)/(ki-kf),f<=0||(cb=(1+f-(1+2*f)**rnd())/f,sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),cf=Math.cos(fai),sf=Math.sin(fai),skk=Math.sqrt(skx+sky),a11=ky/skk,a12=kx*kz/skk/ki,a13=kx/ki,a21=-kx/skk,a22=ky*kz/skk/ki,a23=ky/ki,a32=-skk/ki,a33=kz/ki,x1=kf*sb*cf,x2=kf*sb*sf,x3=kf*cb,kx=a11*x1+a12*x2+a13*x3,ky=a21*x1+a22*x2+a23*x3,kz=a32*x2+a33*x3)}function goto_40(){sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),cf=Math.cos(fai),sf=Math.sin(fai),skk=Math.sqrt(skx+sky),a11=ky/skk,a12=kx*kz/skk/ki,a13=kx/ki,a21=-kx/skk,a22=ky*kz/skk/ki,a23=ky/ki,a32=-skk/ki,a33=kz/ki,x1=kf*sb*cf,x2=kf*sb*sf,x3=kf*cb,kx=a11*x1+a12*x2+a13*x3,ky=a21*x1+a22*x2+a23*x3,kz=a32*x2+a33*x3}function goto_30(){cs=1-2*rnd(),sn=Math.sqrt(1-cs*cs),fai=2*pi*rnd(),kz=kf*cs,kx=kf*sn*Math.cos(fai),ky=kf*sn*Math.sin(fai)}function indkxcic(k,a){if(k>kmesh[nk])return indkxcic_=nk,0,indkxcic_;if(k<kmesh[1])return indkxcic_=1,0,indkxcic_;for(i=1;i<=nk;i++)if(kmesh[1]>=k){ipkx=i,(kmesh[ipkx]-k)/dk,indkxcic_=ipkx;break}return indkxcic>nk?(indkxcic_=nk,0):indkxcic<1&&(indkxcic_=1,0),indkxcic_}function indkxngp(k){if(k>kmesh[nk])return indkxngp_=nk,indkxngp_;if(k<kmesh[1])return indkxngp_=1,indkxngp_;for(i=1;i<=nk;i++)if(kmesh[i]>=k){ipkx=i;break}return diff1=kmesh[ipkx]-k,diff2=k-kmesh[ipkx-1],diff1>=diff2?indkxngp_=ipkx-1:indkxngp_=ipkx,indkxngp>nk&&(indkxngp_=nk),indkxngp<1&&(indkxngp_=1),indkxngp_}function indkxngp2(k){var i;return i=(k*dx/pi+.5)*nk+.5,indkxngp2_=Math.min(nk,Math.max(1,Math.round(i))),indkxngp2_}function surfp(){xp<0?(iv2=9,nout1+=1):xp>xmax&&(iv2=9,nout2+=1)}function driftp(k){9!=iv2&&(i=Math.max(0,Math.min(Math.floor(xp/dx+.5),nx1)),dkx2=-qhf[i]*k,hmtp=hmp*k,xp+=hmtp*(kx2+.5*dkx2),kx2+=dkx2,surfp())}function creap(k){iv2=1,"yes"===ifermi?(re0=1/(1+Math.exp(-efermi/bktq)),ransu=re0*rnd(),ei=efermi-bktq*Math.log(ransu/(1-ransu))):"no"===ifermi&&(eix=-bktq*Math.log(rnd())*.5,eiy=-bktq*Math.log(rnd())*.5,eiz=-bktq*Math.log(rnd())*.5),akx=smhp*Math.sqrt(eix),aky=smhp*Math.sqrt(eiy),akz=smhp*Math.sqrt(eiz),cb=rnd(),sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),sf=Math.sin(fai),cf=Math.cos(fai),kx2=akx,ky2=aky,kz2=akz,ts2=t-Math.log(rnd())/gm1p,1==k?xp=dx*areainj*rnd():2==k&&(kx2=-kx2,xp=xmax-dx*areainj*rnd()),affi=1}function scatp(){9!=iv2&&(skx2=kx2*kx2,sky2=ky2*ky2,skz2=kz2*kz2,sk2=skx2+sky2+skz2,0!=sk2&&(xp<=ivleft*dx||xp>=ivright*dx?goto_1000p():goto_2000p()))}function goto_1000p(){if(ki=Math.sqrt(sk2),ei=hhmp*sk2,ie=Math.max(1,Math.min(Math.floor(ei/de)+1,iemax)),r1=rnd(),r1<=swk2[1][1][ie]){if(ef=ei-hwo,ef<=0)return;nsopte1+=1,goto_20_40p()}else r1<=swk2[1][2][ie]?(ef=ei+hwo,nsopta1+=1,goto_20_40p()):r1<=swk2[1][3][ie]?(ef=ei,kf=ki,nsaco1+=1,goto_30p()):r1<swk2[1][4][ie]&&(ef=ei,r2=rnd(),cb=1-2*r2/(1+4*(1-r2)*sk2/qd2),kf=ki,nsimp1+=1,goto_40p())}function goto_2000p(){if(ki=Math.sqrt(sk2),ei=hhmp*sk2,ie=Math.max(1,Math.min(Math.floor(ei/de)+1,iemax)),r1=rnd(),r1<=swk2[2][1][ie]){if(ef=ei-hwo,ef<=0)return;nsopte2=nsopte1+1,goto_20_40p()}else r1<=swk2[2][2][ie]?(ef=ei+hwo,nsopta2+=1,goto_20_40p()):r1<=swk2[2][3][ie]?(ef=ei,kf=ki,nsaco2+=1,goto_30p()):r1<swk2[2][4][ie]&&(ef=ei,r2=rnd(),cb=1-2*r2/(1+4*(1-r2)*sk2/qd2_w),kf=ki,nsimp2+=1,goto_40p())}function goto_20_40p(){kf=smhp*Math.sqrt(ef),f=2*ki*kf/(ki-kf)/(ki-kf),f<=0||(cb=(1+f-(1+2*f)**rnd())/f,sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),cf=Math.cos(fai),sf=Math.sin(fai),skk=Math.sqrt(skx2+sky2),a11=ky2/skk,a12=kx2*kz2/skk/ki,a13=kx2/ki,a21=-kx2/skk,a22=ky2*kz2/skk/ki,a23=ky2/ki,a32=-skk/ki,a33=kz2/ki,x1=kf*sb*cf,x2=kf*sb*sf,x3=kf*cb,kx2=a11*x1+a12*x2+a13*x3,ky2=a21*x1+a22*x2+a23*x3,kz2=a32*x2+a33*x3)}function goto_40p(){sb=Math.sqrt(1-cb*cb),fai=2*pi*rnd(),cf=Math.cos(fai),sf=Math.sin(fai),skk=Math.sqrt(skx2+sky2),a11=ky2/skk,a12=kx2*kz2/skk/ki,a13=kx2/ki,a21=-kx2/skk,a22=ky2*kz2/skk/ki,a23=ky2/ki,a32=-skk/ki,a33=kz2/ki,x1=kf*sb*cf,x2=kf*sb*sf,x3=kf*cb,kx2=a11*x1+a12*x2+a13*x3,ky2=a21*x1+a22*x2+a23*x3,kz2=a32*x2+a33*x3}function goto_30p(){cs=1-2*rnd(),sn=Math.sqrt(1-cs*cs),fai=2*pi*rnd(),kz2=kf*cs,kx2=kf*sn*Math.cos(fai),ky2=kf*sn*Math.sin(fai)}